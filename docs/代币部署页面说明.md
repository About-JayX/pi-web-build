# 代币部署页面说明

## 一、页面概述

代币部署页面（Deploy Page）是 Pi.Sale 平台的核心功能之一，允许用户创建和部署自己的代币。页面提供直观的表单界面，用户可以设置代币的基本信息、代币经济参数以及社交媒体链接等。

![代币部署页面示意图]

## 二、主要功能模块

### 1. 基本信息设置

此模块允许用户设置代币的基础标识信息：

| 字段 | 说明 | 验证规则 |
|------|------|----------|
| 代币图标 | 代币的标志图像 | 必填，文件大小限制为2MB |
| 代币符号 | 代币的简称，如"BTC" | 必填，最大10个字符，不允许中文，需通过唯一性验证 |
| 代币名称 | 代币的完整名称 | 必填 |

#### 代币符号验证逻辑

代币符号验证包含以下步骤：

1. **输入过滤**：
   - 自动移除空格和中文字符
   - 限制最大长度为10个字符

2. **禁用符号检查**：
   - 系统维护一个禁用符号列表：`["XPI", "PIS", "PiSale", "SpacePi", "Xijinpin"]`
   - 如输入符号在此列表中，立即显示错误提示

3. **唯一性验证**：
   - 对于非禁用符号，延迟1.5秒执行API检查
   - 通过API验证符号是否已被注册
   - 根据API返回结果显示对应提示信息

### 2. 代币参数设置

此模块控制代币的经济参数，包括总供应量和初始铸造金额：

#### 总供应量选项

| 环境 | 可选值 |
|------|-------|
| 生产环境 | 314,000,000 / 1,000,000,000 |
| 测试环境 | 1,000,000 / 314,000,000 / 1,000,000,000 |

#### 初始铸造金额选项

不同总供应量对应不同的铸造金额选项，以PI或SOL为单位：

| 总供应量 | 铸造金额选项 |
|---------|------------|
| 1,000,000 (测试) | 0.1 PI/SOL |
| 314,000,000 | 314 PI/SOL, 157 PI/SOL, 78.5 PI/SOL |
| 1,000,000,000 | 100 PI/SOL, 200 PI/SOL, 250 PI/SOL, 500 PI/SOL |

#### 显示信息

系统会自动计算并显示：

- **交换比率**：1 PI/SOL可兑换多少代币
- **代币价格**：单个代币的价值（以PI/SOL表示）

### 3. 社交媒体链接设置

此模块允许用户添加代币的社交媒体和描述信息：

| 字段 | 说明 | 是否必填 |
|------|------|---------|
| 网站链接 | 代币或项目的官方网站 | 否 |
| Twitter链接 | 代币的Twitter账号 | 否 |
| Telegram链接 | 代币的Telegram群组 | 否 |
| 代币描述 | 代币的详细描述信息 | 否 |

## 三、交互流程

### 1. 钱包连接流程

```
用户点击部署按钮
↓
检查是否已连接钱包
↓
未连接 → 打开钱包连接弹窗 → 用户选择钱包并授权连接
↓
成功连接后保存公钥信息
```

### 2. 代币创建流程

```
用户填写表单并点击部署按钮
↓
前端验证表单数据
↓
验证通过后创建FormData对象
↓
调用API创建代币
↓
成功 → 显示成功弹窗，可跳转查看代币详情
↓
失败 → 显示错误信息
```

### 3. 参数选择流程

代币参数选择根据设备类型有不同的交互方式：

- **移动端**：使用折叠面板形式显示选项
- **PC端**：点击参数打开Modal弹窗进行选择

## 四、数据处理与验证

### 1. 表单验证规则

系统在提交前会验证以下关键事项：

- 必填字段（代币图标、符号、名称）是否已填写
- 代币符号是否已通过唯一性验证
- 代币符号是否不在禁用列表中
- 图片大小是否在允许范围内（≤2MB）

### 2. 代币创建参数构建

最终提交的代币创建参数结构如下：

```typescript
interface CreateTokenParams {
  file: File;  // 代币图标文件
  Metadata: {
    name: string;  // 代币名称
    symbol: string;  // 代币符号
    description: string;  // 代币描述
    init_liquidity: number;  // 初始流动性（铸造金额，已转换为纳秒精度）
    total_supply: number;  // 总供应量（已转换为百万代币单位）
    socials: Array<{  // 社交媒体链接
      platform: 'telegram' | 'twitter' | 'website';
      url: string;
    }>;
  };
}
```

## 五、网络和环境适配

### 1. 网络适配

系统根据当前选择的网络自动调整计价单位：

- **Pi Network**: 计价单位为PI
- **Solana**: 计价单位为SOL

### 2. 环境差异

开发环境和生产环境有以下区别：

| 功能/特性 | 开发环境 | 生产环境 |
|---------|---------|---------|
| 测试代币选项 | 提供100万供应量选项 | 仅提供标准供应量选项 |
| 错误处理 | 显示详细错误弹窗 | 仅显示简化错误提示 |
| 调试信息 | 控制台输出完整参数和过程 | 最小化日志输出 |

## 六、响应式设计策略

页面针对不同设备类型进行了优化适配：

### 1. 移动端优化

- 使用折叠面板代替Modal弹窗
- 垂直排列表单元素
- 简化交互流程

### 2. PC端优化

- 使用Modal弹窗提供更丰富的交互体验
- 水平布局提供更高效的空间利用
- 自动计算和实时预览功能

## 七、常见问题及解决方案

### 1. 为什么我的代币符号被拒绝？

**解答**：代币符号可能因以下原因被拒绝：
- 包含在禁用列表中（如"XPI"，"PiSale"等）
- 符号已被其他代币使用
- 包含不支持的字符（如中文字符）

### 2. 如何选择适合的铸造金额？

**解答**：铸造金额决定了初始代币流动性。对于314M供应量，建议选择157或314 PI/SOL；对于10亿供应量，建议选择250或500 PI/SOL以获得更好的流动性。

### 3. 部署后还能修改代币信息吗？

**解答**：代币一旦部署到区块链上，核心参数（如符号、名称、总供应量）无法修改。但社交媒体链接和描述可以通过平台更新。

### 4. 为什么要限制代币图标大小？

**解答**：限制代币图标大小（≤2MB）是为了优化存储空间和加载性能，确保用户体验的同时控制平台存储成本。

## 八、开发和维护建议

1. **组件拆分**：
   - 将页面组件进一步拆分以提高复用性
   - 考虑将验证逻辑抽离为自定义钩子

2. **表单管理优化**：
   - 考虑使用Formik或React Hook Form替代原生状态管理
   - 添加更完善的表单验证机制

3. **用户体验改进**：
   - 增加代币创建进度指示器
   - 提供代币参数对比功能帮助用户决策 